% !TEX encoding = UTF-8
%Koma article
\documentclass[fontsize=12pt,paper=letter,twoside]{scrartcl}
\usepackage{float}
\usepackage{listings}
\usepackage{makecell}

%Standard Pre-amble
\input{sty/defns.tex}
%Useful definitions
%\newcommand{\mv}[1]{\textit{m\_#1}}
%\newcommand{\cv}[1]{\textit{c\_#1}}
%\newcommand{\degree}[1]{^{\circ}\mathrm{#1}}
%\newcommand{\comment}[1]{{\footnotesize \quad\texttt{--}\textrm{#1}}}

% Set the header
\ihead[]{\small EECS4313 Assignment-2}


%%%%%%%%%%%%Enter your names here%%%%%%%%
\author{Student Name | Student Number | EECS Account
\and \textbf{Edward Vaisman | 212849857 | eddyv}
\and \textbf{Robin Bandzar | 212200531 | cse23028}
\and \textbf{Kirusanth Thiruchelvam | 212918298 | kirusant}
\and \textbf{Sadman Sakib Hasan | 212497509 | cse23152}
}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\date{\today} % Display a given date or no date

\begin{document}
\title{EECS 4313 Assignment 2 \\Black-box and White-box Testing with JUnit}
\maketitle

\newpage

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\tableofcontents


\newpage


%%%%Rest of your document goes here%%%%%%%%%%%%%%%%%%%

\section{Black Box Testing}
\label{bbt}

\begin{itemize}
\item Specification of the selected Java methods.
\item Justification of the testing technique chosen, i.e., why is it appropriate for this method.
\item Description of your application of the three testing strategies. Be clear about which test cases
you implemented.
\item Evaluation of the test cases derived by the testing technique. Include the screenshots of the
test running results. If you had to complement the derived test cases with special value 
testing, describe that as well. The marker will not read your code in order to see what you
tested. You have to describe it.
\item Attaching bug reports if bugs are discovered using your testing methods. You should use the
same bug report format as in Assignment 1. Do not file these bug reports to the project’s bug
report system. 
\end{itemize}

\newpage
\section{White Box Testing}

\begin{itemize}
\item The statement coverage measurements for your Assignment 2 test suite.
\item A description of the test cases that you added in this assignment to improve statement
coverage. The marker will not read your code in order to see what you tested. You have to
describe it.
\item The statement coverage measurements for your final submission. Include the screenshots of
the test running results and the screenshots of the coverage measurement. If your coverage is
not 100%, include a discussion on why that is.
\item The Control Flow Graph you created. Indicate the segments clearly (you will probably need
to include the code for this).
\item The path coverage discussion described in section 2 above.
\item Attaching bug reports if bugs are discovered using your testing methods. You should use the
same bug report format as in Assignment 1. Do not file these bug reports to the project’s bug
report system.
\item An appendix with the specification of the methods you are testing (if there are new ones). 
\end{itemize}

\newpage
\subsection{Decision Table Testing}

\begin{itemize}
\item \textbf{Technique}: \emph{Decision Table Testing}
\item \textbf{Class}: \emph{net.sf.borg.common.DateUtil.java}
\item \textbf{Method}: \emph{isAfter(Date d1, Date d2)}
\item \textbf{Method description}: The method checks if a given date \emph{d1} falls on a later calendar day than date \emph{d2}. It returns \textbf{true} if \emph{d1} does fall on a later calendar day than \emph{d2} and \textbf{false} otherwise.
\begin{itemize}
\item \textbf{d1} - The first argument is of type Java Date Object.
\item \textbf{d2} - The second argument is of type Java Date Object.
\end{itemize}
\item \textbf{Justification}: Decision table testing technique is an appropriate testing technique for this method because there are decision making to be done among the input variables. It consists of logical relationships among the input variables, i.e date \emph{d1} appearing before, after or at the same time as date \emph{d2}, which directly affects the output.
\end{itemize}

\begin{figure}[!htb]
\begin{center}
\includegraphics[width=.99\textwidth]{images/wbt/dtt/test-run.png}
\end{center}
\caption{Test run result for the isAfter function}
\label{fig:wbt_dtt_test_run}
\end{figure}

\begin{figure}[!htb]
\begin{center}
\includegraphics[width=.99\textwidth]{images/wbt/dtt/code.png}
\end{center}
\caption{Statement Coverage View for the isAfter function}
\label{fig:wbt_dtt_code}
\end{figure}

\begin{figure}[!htb]
\begin{center}
\includegraphics[width=.99\textwidth]{images/wbt/dtt/code-coverage.png}
\end{center}
\caption{Statement Coverage Metrics for the isAfter function}
\label{fig:wbt_dtt_code_coverage}
\end{figure}

\newpage
\subsubsection{Control Flow Graph}

The following is the code snippet for the \emph{isAfter} function:

\newpage
\begin{code}
	/**
	 * Checks if one date falls on a later calendar day than
	 * another.
	 * 
	 * @param d1
	 *            the first date
	 * @param d2
	 *            the second date
	 * 
	 * @return true, if is after
	 */
	1. public static boolean isAfter(Date d1, Date d2) {

	2.	GregorianCalendar tcal = new GregorianCalendar();
	3.	tcal.setTime(d1);
	4.	tcal.set(Calendar.HOUR_OF_DAY, 0);
	5.	tcal.set(Calendar.MINUTE, 0);
	6.	tcal.set(Calendar.SECOND, 0);
	7.	GregorianCalendar dcal = new GregorianCalendar();
	8.	dcal.setTime(d2);
	9.	dcal.set(Calendar.HOUR_OF_DAY, 0);
	10.	dcal.set(Calendar.MINUTE, 10);
	11.	dcal.set(Calendar.SECOND, 0);

	12.	if (tcal.getTime().after(dcal.getTime())) {
	13.		return true;
	14.	}

	15.	return false;
	16. }
\end{code}

\begin{table}[h]
\centering
\begin{tabular}{|c | c |}
	\cline{1-2}
	\textbf{Name} & \textbf{Covered Statements}\\ \hline
	A & from line 1 to 11 \\ \hline
	B & if (tcal.getTime().after(dcal.getTime())) \\ \hline
	C & return true; \\ \Xhline{2pt}
	D & return false; \\ \hline
\end{tabular}
\caption {CFG Segment Table for the isAfter method}
\label{tbl:dtt_cfg_segments}
\end{table}

\begin{figure}[!htb]
\begin{center}
\includegraphics[width=.99\textwidth]{images/wbt/dtt/dtt_cfg.pdf}
\end{center}
\caption{Control Flow Graph for the isAfter function}
\label{fig:wbt_dtt_cfg}
\end{figure}

\clearpage
\newpage
\begin{itemize}
\item \textbf{Number of paths in the method}: 2
\begin{itemize}
\item \textbf{Path P1} - The first path is when the method returns \emph{true} if date d1 is after date d2. Following the CFG diagram above, refer to diagram \ref{fig:wbt_dtt_cfg}, this is path is: \textbf{ABC}.
\item \textbf{Path P2} - The second path is when the method returns \emph{false} if date d1 is not after date d2 (i.e d1 is either equal to or before d2). Following the CFG diagram above, refer to diagram \ref{fig:wbt_dtt_cfg}, this is path is: \textbf{ABD}.
\end{itemize}
\item \textbf{Estimated \% of path covered in the test}: 100\%
\end{itemize}

\noindent The following code snippet depicts the test case and path coverages for \emph{isAfter} function:
\begin{code}
	@Test
	public void testIsAfter() {
		/** Method used: Decision Table Testing **/
		
		Date d1 = new Date(117, 11, 3);
		Date d2 = new Date(117, 11, 3);
		boolean result;
		
		// date d1 is equal to d2
		result = DateUtil.isAfter(d1, d2);
		assertFalse("Date d1 is equal to d2", result);
		
		// date d1 is before d2
		d1.setDate(2);
		result = DateUtil.isAfter(d1, d2);
		assertFalse("Date d1 is before d2", result);
		
		// date d1 is after d2
		d1.setDate(4);
		result = DateUtil.isAfter(d1, d2);
		assertTrue("Date d1 is after d2", result);
	}
\end{code}

\newpage
\noindent Path coverage \textbf{P1}:
\begin{code}
		// date d1 is after d2
		d1.setDate(4);
		result = DateUtil.isAfter(d1, d2);
		assertTrue("Date d1 is after d2", result);
\end{code}

\noindent Path coverage \textbf{P2}:
\begin{code}
		// date d1 is equal to d2
		result = DateUtil.isAfter(d1, d2);
		assertFalse("Date d1 is equal to d2", result);
		
		// date d1 is before d2
		d1.setDate(2);
		result = DateUtil.isAfter(d1, d2);
		assertFalse("Date d1 is before d2", result);
\end{code}

\end{document}
